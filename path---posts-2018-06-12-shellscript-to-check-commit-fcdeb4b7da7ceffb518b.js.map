{"version":3,"sources":["webpack:///path---posts-2018-06-12-shellscript-to-check-commit-fcdeb4b7da7ceffb518b.js","webpack:///./.cache/json/posts-2018-06-12-shellscript-to-check-commit.json"],"names":["webpackJsonp","895","module","exports","data","site","siteMetadata","title","url","author","markdownRemark","html","timeToRead","fields","tagSlugs","frontmatter","tags","date","mainImageAlt","description","mainImage","childImageSharp","sizes","aspectRatio","base64","src","srcSet","pathContext","slug"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,cAAgBC,MAAA,oBAAAC,IAAA,4BAAAC,OAAA,YAAkFC,gBAAmBC,KAAA,40OAAikNC,WAAA,EAAAC,QAA6iCC,UAAA,qCAAgDC,aAAgBR,MAAA,4BAAAS,MAAA,sBAAAC,KAAA,aAAAC,aAAA,4DAAAC,YAAA,sFAAAC,WAAkRC,iBAAmBC,OAASC,YAAA,IAAAC,OAAA,k0BAA4CF,MAAA,oCAAAG,IAAA,kFAAAC,OAAA,oWAAiyCC,aAAgBC,KAAA","file":"path---posts-2018-06-12-shellscript-to-check-commit-fcdeb4b7da7ceffb518b.js","sourcesContent":["webpackJsonp([219968351057785],{\n\n/***/ 895:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"rhostem.github.io\",\"url\":\"https://rhostem.github.io\",\"author\":\"rhostem\"}},\"markdownRemark\":{\"html\":\"<p>Git으로 버전 관리를 하고 있지만 <a href=\\\"https://ko.wikipedia.org/wiki/%EC%A7%80%EC%86%8D%EC%A0%81_%ED%86%B5%ED%95%A9\\\">CI</a> 도구를 사용하고 있지 않다면, 최소한 앱을 배포하기 전에 커밋을 하고 원격 저장소에 푸시를 해야 한다. 그래야 개발 서버든 운영 서버든 간에 현재 배포된 앱이 어떤 버전인지 일 수 있고 버그 수정도 원만하게 할 수 있기 때문이다. 이런 과정을 추가하면 아무리 버그를 급하게 수정해야 하는 상황이라도 자신의 코드를 한번은 돌아보게 만드는 만드는 효과를 줄 수 있다고 본다. 버전 관리를 하면서도 아무런 의미없는 커밋을 남발해도 된다는 마음을 가진 사람은 드물 테니까 말이다.</p>\\n<h2 id=\\\"쉘-스크립트\\\"><a href=\\\"#%EC%89%98-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>쉘 스크립트</h2>\\n<p>쉘(Shell)은 유닉스 및 유닉스 계열 운영체제의 커맨드라인 인터페이스를 의미하며 리눅스, 맥 OS의 기본 쉘로는 bash가 제공된다. 개인적으로는 더 다양한 기능을 제공하는 <a href=\\\"http://www.zsh.org/\\\">zsh</a>과 <a href=\\\"http://ohmyz.sh/\\\">Oh My Zsh</a>의 조합을 사용하고 있다.</p>\\n<p>그리고 쉘에서는 웹 브라우저의 콘솔에서 자바스크립트 코드를 사용할 수 있는 것처럼 쉘 스크립트 코드를 실행할 수 있다. 쉘 스크립트를 사용하면 파일 입출력, 연속적인 명령어 실행, 사용자 인터페이스 구현 등이 가능해진다. Git 저장소의 커밋 및 푸시 여부도 쉘 스크립트 안에서 Git 명령어의 실행을 조합하는 방식으로 구현할 수 있다.</p>\\n<h2 id=\\\"쉘-스크립트를-사용해서-현재-브랜치-정보-확인하기\\\"><a href=\\\"#%EC%89%98-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%84%9C-%ED%98%84%EC%9E%AC-%EB%B8%8C%EB%9E%9C%EC%B9%98-%EC%A0%95%EB%B3%B4-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>쉘 스크립트를 사용해서 현재 브랜치 정보 확인하기</h2>\\n<p>쉘 스크립트에도 프로그래밍 언어인 만큼 변수를 사용할 수 있다. Git 명령어를 이용해 현재 브랜치의 이름, 현재 작업중인 로컬 브랜치(HEAD)의 커밋 해시 스트링, 그리고 원격 저장소의 커밋 해시 스트링을 저장한다.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token comment\\\"># 현재 브랜치 이름을 변수에 할당</span>\\nBRANCH<span class=\\\"token operator\\\">=</span><span class=\\\"token variable\\\"><span class=\\\"token variable\\\">$(</span><span class=\\\"token function\\\">git</span> rev-parse --abbrev-ref HEAD<span class=\\\"token variable\\\">)</span></span>\\n\\n<span class=\\\"token comment\\\"># 현재 브랜치의 최종 커밋의 해시값</span>\\nHASH<span class=\\\"token operator\\\">=</span><span class=\\\"token variable\\\"><span class=\\\"token variable\\\">$(</span><span class=\\\"token function\\\">git</span> rev-parse HEAD<span class=\\\"token variable\\\">)</span></span>\\n\\n<span class=\\\"token comment\\\"># 원격에 업로드된 현재 브랜치의 커밋 해시</span>\\nREMOTE_HASH<span class=\\\"token operator\\\">=</span><span class=\\\"token variable\\\"><span class=\\\"token variable\\\">$(</span><span class=\\\"token function\\\">git</span> rev-parse --verify origin/$BRANCH<span class=\\\"token variable\\\">)</span></span></code></pre>\\n      </div>\\n<p><code class=\\\"language-text\\\">BRANCH</code>에 현재 브랜치의 이름을 할당한 후 원격 저장소의 커밋 해시를 가져온 후 사용했다. 변수를 사용할 때는 선언할 때와 달리 달러($) 사인을 붙여서 사용해야 한다.</p>\\n<p>필요한 값을 가져왔으니 이제 조건문을 사용해 배포가 가능한 상황인지 확인하면 된다. 조건문은 <code class=\\\"language-text\\\">if</code> ~ <code class=\\\"language-text\\\">fi</code>로 블록을 형성할 수 있고 <code class=\\\"language-text\\\">then</code> 키워드 후에 조건문을 만족했을 때 실행할 코드를 입력한다. 아래 코드에서는 현재 브랜치가 master 브랜치인지 확인한다.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">[</span> <span class=\\\"token string\\\">\\\"<span class=\\\"token variable\\\">$BRANCH</span>\\\"</span> <span class=\\\"token operator\\\">!=</span> <span class=\\\"token string\\\">\\\"master\\\"</span> <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token keyword\\\">then</span>\\n  <span class=\\\"token keyword\\\">echo</span> <span class=\\\"token string\\\">'master 브랜치에서만 배포 가능합니다.'</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\"># 메시지 출력</span>\\n  <span class=\\\"token keyword\\\">exit</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\"># 스트립트 종료</span>\\n<span class=\\\"token keyword\\\">fi</span></code></pre>\\n      </div>\\n<p>다음으로는 커밋되지 않은 변경 사항이 있는지 확인해야 한다. 역시 Git 명령어를 사용해야 한다. <code class=\\\"language-text\\\">git status --porcelain</code> 명령어는 저장소의 변경 사항을 아래와 같은 방식으로 간단히 출력한다.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token comment\\\"># ?? 기호는 Git index에 추가되지 않은 파일이라는 의미다</span>\\n?? src/pages/posts/2018-06-12-shellscript-to-check-commit/</code></pre>\\n      </div>\\n<p>만약 변경 사항이 없다면 아무것도 출력되지 않는다. 그래서 문자열이 null이 아니라면 true를 반환하는 <code class=\\\"language-text\\\">-n</code> 키워드를 사용해서 커밋되지 않은 파일이 있는지 확인할 수 있다.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">[</span> -n <span class=\\\"token string\\\">\\\"<span class=\\\"token variable\\\"><span class=\\\"token variable\\\">$(</span><span class=\\\"token function\\\">git</span> status --porcelain<span class=\\\"token variable\\\">)</span></span>\\\"</span> <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token keyword\\\">then</span>\\n  <span class=\\\"token keyword\\\">echo</span> <span class=\\\"token string\\\">\\\"배포 전 모든 변경 사항을 커밋해야 합니다.\\\"</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">exit</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">fi</span></code></pre>\\n      </div>\\n<p>그리고 마지막으로 현재 브랜치의 커밋과 원격 브랜치의 커밋이 일치하는지 확인한다.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">[</span> <span class=\\\"token variable\\\">$HASH</span> <span class=\\\"token operator\\\">!=</span> <span class=\\\"token variable\\\">$REMOTE_HASH</span> <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token keyword\\\">then</span>\\n  <span class=\\\"token keyword\\\">echo</span> <span class=\\\"token string\\\">\\\"배포 전 모든 커밋을 원격에 푸시해야 합니다.\\\"</span>\\n  <span class=\\\"token keyword\\\">exit</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">fi</span></code></pre>\\n      </div>\\n<p>이렇게 확인 과정이 끝났으므로 스크립트의 나머지 부분에서는 실제 배포를 수행하는 <code class=\\\"language-text\\\">npm run deploy</code> 같은 명령어를 실행할 수 있다.</p>\\n<hr>\\n<h2 id=\\\"참고자료\\\"><a href=\\\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>참고자료</h2>\\n<ul>\\n<li><a href=\\\"http://codewiki.wikidot.com/shell-script\\\">Shell Scripting (Linux/Unix) - Code Wiki</a></li>\\n<li><a href=\\\"https://blog.gaerae.com/2015/01/bash-hello-world.html\\\">Bash 입문자를 위한 핵심 요약 정리 (Shell Script) - 개발자스럽다</a></li>\\n</ul>\",\"timeToRead\":3,\"fields\":{\"tagSlugs\":[\"/tags/git/\",\"/tags/shell-script/\"]},\"frontmatter\":{\"title\":\"Git 커밋 상태를 확인하기 위한 쉘 스크립트\",\"tags\":[\"Git\",\"Shell Script\"],\"date\":\"2018-06-12\",\"mainImageAlt\":\"photo by Ashim D’Silva (https://unsplash.com/@randomlies)\",\"description\":\"Git 커밋 상태를 확인하기 위한 쉘 스크립트. 쉘 스크립트를 사용해 앱 배포 전에 현재 변경사항이 커밋되었고, 원격에 배포되었는지 확인할 수 있다.\",\"mainImage\":{\"childImageSharp\":{\"sizes\":{\"aspectRatio\":1.5,\"base64\":\"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAABQunNRsLB/8QAGBAAAwEBAAAAAAAAAAAAAAAAAQIDABH/2gAIAQEAAQUCWrYMJKb26MD0d3//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAdEAABAwUBAAAAAAAAAAAAAAABABAhAhESMlFx/9oACAEBAAY/AtQUQKcj1QbeNLf/xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhMVH/2gAIAQEAAT8hSaU0LkDVXB7geIaGmo//2gAMAwEAAgADAAAAEEfP/8QAGREAAgMBAAAAAAAAAAAAAAAAAAERITFh/9oACAEDAQE/ENVonh//xAAXEQEBAQEAAAAAAAAAAAAAAAARAAFh/9oACAECAQE/EHVY7f/EABsQAQEBAAIDAAAAAAAAAAAAAAERACExQVGx/9oACAEBAAE/EKtWFfveDitUEfXJ596i4KBQM0KtmaKre8gy7//Z\",\"sizes\":\"(max-width: 1600px) 100vw, 1600px\",\"src\":\"/static/ashim-d-silva-95242-unsplash-5b8c0e41c0435b2d5168a815d111dcca-d60e4.jpg\",\"srcSet\":\"/static/ashim-d-silva-95242-unsplash-5b8c0e41c0435b2d5168a815d111dcca-d3cb5.jpg 400w,\\n/static/ashim-d-silva-95242-unsplash-5b8c0e41c0435b2d5168a815d111dcca-0a0f4.jpg 800w,\\n/static/ashim-d-silva-95242-unsplash-5b8c0e41c0435b2d5168a815d111dcca-d60e4.jpg 1600w,\\n/static/ashim-d-silva-95242-unsplash-5b8c0e41c0435b2d5168a815d111dcca-85014.jpg 1800w\"}}}}}},\"pathContext\":{\"slug\":\"/posts/2018-06-12-shellscript-to-check-commit/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---posts-2018-06-12-shellscript-to-check-commit-fcdeb4b7da7ceffb518b.js","module.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"rhostem.github.io\",\"url\":\"https://rhostem.github.io\",\"author\":\"rhostem\"}},\"markdownRemark\":{\"html\":\"<p>Git으로 버전 관리를 하고 있지만 <a href=\\\"https://ko.wikipedia.org/wiki/%EC%A7%80%EC%86%8D%EC%A0%81_%ED%86%B5%ED%95%A9\\\">CI</a> 도구를 사용하고 있지 않다면, 최소한 앱을 배포하기 전에 커밋을 하고 원격 저장소에 푸시를 해야 한다. 그래야 개발 서버든 운영 서버든 간에 현재 배포된 앱이 어떤 버전인지 일 수 있고 버그 수정도 원만하게 할 수 있기 때문이다. 이런 과정을 추가하면 아무리 버그를 급하게 수정해야 하는 상황이라도 자신의 코드를 한번은 돌아보게 만드는 만드는 효과를 줄 수 있다고 본다. 버전 관리를 하면서도 아무런 의미없는 커밋을 남발해도 된다는 마음을 가진 사람은 드물 테니까 말이다.</p>\\n<h2 id=\\\"쉘-스크립트\\\"><a href=\\\"#%EC%89%98-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>쉘 스크립트</h2>\\n<p>쉘(Shell)은 유닉스 및 유닉스 계열 운영체제의 커맨드라인 인터페이스를 의미하며 리눅스, 맥 OS의 기본 쉘로는 bash가 제공된다. 개인적으로는 더 다양한 기능을 제공하는 <a href=\\\"http://www.zsh.org/\\\">zsh</a>과 <a href=\\\"http://ohmyz.sh/\\\">Oh My Zsh</a>의 조합을 사용하고 있다.</p>\\n<p>그리고 쉘에서는 웹 브라우저의 콘솔에서 자바스크립트 코드를 사용할 수 있는 것처럼 쉘 스크립트 코드를 실행할 수 있다. 쉘 스크립트를 사용하면 파일 입출력, 연속적인 명령어 실행, 사용자 인터페이스 구현 등이 가능해진다. Git 저장소의 커밋 및 푸시 여부도 쉘 스크립트 안에서 Git 명령어의 실행을 조합하는 방식으로 구현할 수 있다.</p>\\n<h2 id=\\\"쉘-스크립트를-사용해서-현재-브랜치-정보-확인하기\\\"><a href=\\\"#%EC%89%98-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%84%9C-%ED%98%84%EC%9E%AC-%EB%B8%8C%EB%9E%9C%EC%B9%98-%EC%A0%95%EB%B3%B4-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>쉘 스크립트를 사용해서 현재 브랜치 정보 확인하기</h2>\\n<p>쉘 스크립트에도 프로그래밍 언어인 만큼 변수를 사용할 수 있다. Git 명령어를 이용해 현재 브랜치의 이름, 현재 작업중인 로컬 브랜치(HEAD)의 커밋 해시 스트링, 그리고 원격 저장소의 커밋 해시 스트링을 저장한다.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token comment\\\"># 현재 브랜치 이름을 변수에 할당</span>\\nBRANCH<span class=\\\"token operator\\\">=</span><span class=\\\"token variable\\\"><span class=\\\"token variable\\\">$(</span><span class=\\\"token function\\\">git</span> rev-parse --abbrev-ref HEAD<span class=\\\"token variable\\\">)</span></span>\\n\\n<span class=\\\"token comment\\\"># 현재 브랜치의 최종 커밋의 해시값</span>\\nHASH<span class=\\\"token operator\\\">=</span><span class=\\\"token variable\\\"><span class=\\\"token variable\\\">$(</span><span class=\\\"token function\\\">git</span> rev-parse HEAD<span class=\\\"token variable\\\">)</span></span>\\n\\n<span class=\\\"token comment\\\"># 원격에 업로드된 현재 브랜치의 커밋 해시</span>\\nREMOTE_HASH<span class=\\\"token operator\\\">=</span><span class=\\\"token variable\\\"><span class=\\\"token variable\\\">$(</span><span class=\\\"token function\\\">git</span> rev-parse --verify origin/$BRANCH<span class=\\\"token variable\\\">)</span></span></code></pre>\\n      </div>\\n<p><code class=\\\"language-text\\\">BRANCH</code>에 현재 브랜치의 이름을 할당한 후 원격 저장소의 커밋 해시를 가져온 후 사용했다. 변수를 사용할 때는 선언할 때와 달리 달러($) 사인을 붙여서 사용해야 한다.</p>\\n<p>필요한 값을 가져왔으니 이제 조건문을 사용해 배포가 가능한 상황인지 확인하면 된다. 조건문은 <code class=\\\"language-text\\\">if</code> ~ <code class=\\\"language-text\\\">fi</code>로 블록을 형성할 수 있고 <code class=\\\"language-text\\\">then</code> 키워드 후에 조건문을 만족했을 때 실행할 코드를 입력한다. 아래 코드에서는 현재 브랜치가 master 브랜치인지 확인한다.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">[</span> <span class=\\\"token string\\\">\\\"<span class=\\\"token variable\\\">$BRANCH</span>\\\"</span> <span class=\\\"token operator\\\">!=</span> <span class=\\\"token string\\\">\\\"master\\\"</span> <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token keyword\\\">then</span>\\n  <span class=\\\"token keyword\\\">echo</span> <span class=\\\"token string\\\">'master 브랜치에서만 배포 가능합니다.'</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\"># 메시지 출력</span>\\n  <span class=\\\"token keyword\\\">exit</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\"># 스트립트 종료</span>\\n<span class=\\\"token keyword\\\">fi</span></code></pre>\\n      </div>\\n<p>다음으로는 커밋되지 않은 변경 사항이 있는지 확인해야 한다. 역시 Git 명령어를 사용해야 한다. <code class=\\\"language-text\\\">git status --porcelain</code> 명령어는 저장소의 변경 사항을 아래와 같은 방식으로 간단히 출력한다.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token comment\\\"># ?? 기호는 Git index에 추가되지 않은 파일이라는 의미다</span>\\n?? src/pages/posts/2018-06-12-shellscript-to-check-commit/</code></pre>\\n      </div>\\n<p>만약 변경 사항이 없다면 아무것도 출력되지 않는다. 그래서 문자열이 null이 아니라면 true를 반환하는 <code class=\\\"language-text\\\">-n</code> 키워드를 사용해서 커밋되지 않은 파일이 있는지 확인할 수 있다.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">[</span> -n <span class=\\\"token string\\\">\\\"<span class=\\\"token variable\\\"><span class=\\\"token variable\\\">$(</span><span class=\\\"token function\\\">git</span> status --porcelain<span class=\\\"token variable\\\">)</span></span>\\\"</span> <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token keyword\\\">then</span>\\n  <span class=\\\"token keyword\\\">echo</span> <span class=\\\"token string\\\">\\\"배포 전 모든 변경 사항을 커밋해야 합니다.\\\"</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">exit</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">fi</span></code></pre>\\n      </div>\\n<p>그리고 마지막으로 현재 브랜치의 커밋과 원격 브랜치의 커밋이 일치하는지 확인한다.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">[</span> <span class=\\\"token variable\\\">$HASH</span> <span class=\\\"token operator\\\">!=</span> <span class=\\\"token variable\\\">$REMOTE_HASH</span> <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token keyword\\\">then</span>\\n  <span class=\\\"token keyword\\\">echo</span> <span class=\\\"token string\\\">\\\"배포 전 모든 커밋을 원격에 푸시해야 합니다.\\\"</span>\\n  <span class=\\\"token keyword\\\">exit</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">fi</span></code></pre>\\n      </div>\\n<p>이렇게 확인 과정이 끝났으므로 스크립트의 나머지 부분에서는 실제 배포를 수행하는 <code class=\\\"language-text\\\">npm run deploy</code> 같은 명령어를 실행할 수 있다.</p>\\n<hr>\\n<h2 id=\\\"참고자료\\\"><a href=\\\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>참고자료</h2>\\n<ul>\\n<li><a href=\\\"http://codewiki.wikidot.com/shell-script\\\">Shell Scripting (Linux/Unix) - Code Wiki</a></li>\\n<li><a href=\\\"https://blog.gaerae.com/2015/01/bash-hello-world.html\\\">Bash 입문자를 위한 핵심 요약 정리 (Shell Script) - 개발자스럽다</a></li>\\n</ul>\",\"timeToRead\":3,\"fields\":{\"tagSlugs\":[\"/tags/git/\",\"/tags/shell-script/\"]},\"frontmatter\":{\"title\":\"Git 커밋 상태를 확인하기 위한 쉘 스크립트\",\"tags\":[\"Git\",\"Shell Script\"],\"date\":\"2018-06-12\",\"mainImageAlt\":\"photo by Ashim D’Silva (https://unsplash.com/@randomlies)\",\"description\":\"Git 커밋 상태를 확인하기 위한 쉘 스크립트. 쉘 스크립트를 사용해 앱 배포 전에 현재 변경사항이 커밋되었고, 원격에 배포되었는지 확인할 수 있다.\",\"mainImage\":{\"childImageSharp\":{\"sizes\":{\"aspectRatio\":1.5,\"base64\":\"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAABQunNRsLB/8QAGBAAAwEBAAAAAAAAAAAAAAAAAQIDABH/2gAIAQEAAQUCWrYMJKb26MD0d3//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAdEAABAwUBAAAAAAAAAAAAAAABABAhAhESMlFx/9oACAEBAAY/AtQUQKcj1QbeNLf/xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhMVH/2gAIAQEAAT8hSaU0LkDVXB7geIaGmo//2gAMAwEAAgADAAAAEEfP/8QAGREAAgMBAAAAAAAAAAAAAAAAAAERITFh/9oACAEDAQE/ENVonh//xAAXEQEBAQEAAAAAAAAAAAAAAAARAAFh/9oACAECAQE/EHVY7f/EABsQAQEBAAIDAAAAAAAAAAAAAAERACExQVGx/9oACAEBAAE/EKtWFfveDitUEfXJ596i4KBQM0KtmaKre8gy7//Z\",\"sizes\":\"(max-width: 1600px) 100vw, 1600px\",\"src\":\"/static/ashim-d-silva-95242-unsplash-5b8c0e41c0435b2d5168a815d111dcca-d60e4.jpg\",\"srcSet\":\"/static/ashim-d-silva-95242-unsplash-5b8c0e41c0435b2d5168a815d111dcca-d3cb5.jpg 400w,\\n/static/ashim-d-silva-95242-unsplash-5b8c0e41c0435b2d5168a815d111dcca-0a0f4.jpg 800w,\\n/static/ashim-d-silva-95242-unsplash-5b8c0e41c0435b2d5168a815d111dcca-d60e4.jpg 1600w,\\n/static/ashim-d-silva-95242-unsplash-5b8c0e41c0435b2d5168a815d111dcca-85014.jpg 1800w\"}}}}}},\"pathContext\":{\"slug\":\"/posts/2018-06-12-shellscript-to-check-commit/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/posts-2018-06-12-shellscript-to-check-commit.json\n// module id = 895\n// module chunks = 219968351057785"],"sourceRoot":""}